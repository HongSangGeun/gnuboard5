<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" th:href="@{/js/font-awesome/css/font-awesome.min.css}">

    <link rel="stylesheet" th:href="@{/css/default.css}">
    <link rel="stylesheet" th:href="@{/css/index.css}">

    <title th:text="${board.boSubject} + ' - 목록'"></title>
    <style>
        body { font-family: Arial, sans-serif; margin: 24px; }
        table { width: 100%; border-collapse: collapse; }
        th, td { border-bottom: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background: #f5f5f5; }
        .pagination { margin-top: 16px; }
        .pagination a { margin-right: 8px; }
    </style>
</head>
<body>
<div th:replace="~{fragments/nav :: nav}"></div>
<div id="wrapper">
    <div id="container_wr">
        <div id="container">
            <h1 id="container_title" th:text="${pageTitle} ?: (board != null ? board.boSubject : '게시판')">게시판</h1>
<h1 th:text="${board.boSubject}">게시판</h1>

<div th:if="${(loginUser != null && loginUser.level >= board.boWriteLevel) || (loginUser == null && board.boWriteLevel <= 1)}">
    <a th:href="@{'/bbs/' + ${boTable} + '/write'}">글쓰기</a>
</div>

<form method="get" th:action="@{'/bbs/' + ${boTable} + '/list'}" style="margin: 12px 0;">
    <input type="hidden" name="page" value="1" />
    <input type="hidden" name="size" th:value="${result.size}" />
    <span th:if="${board.boUseCategory == 1}">
        <select name="sca">
            <option value="">전체 분류</option>
            <option th:each="cat : ${#strings.arraySplit(board.boCategoryList, '|')}"
                    th:value="${cat}"
                    th:selected="${sca == cat}"
                    th:text="${cat}">분류</option>
        </select>
    </span>
    <select name="sfl">
        <option value="wr_subject" th:selected="${sfl == 'wr_subject'}">제목</option>
        <option value="wr_content" th:selected="${sfl == 'wr_content'}">내용</option>
        <option value="wr_subject||wr_content" th:selected="${sfl == 'wr_subject||wr_content'}">제목+내용</option>
        <option th:if="${loginUser != null && loginUser.level >= 10}" value="mb_id,1" th:selected="${sfl == 'mb_id,1'}">회원아이디</option>
        <option th:if="${loginUser != null && loginUser.level >= 10}" value="mb_id,0" th:selected="${sfl == 'mb_id,0'}">회원아이디(코)</option>
        <option value="wr_name,1" th:selected="${sfl == 'wr_name,1'}">글쓴이</option>
        <option value="wr_name,0" th:selected="${sfl == 'wr_name,0'}">글쓴이(코)</option>
    </select>
    <input type="text" name="stx" th:value="${stx}" placeholder="검색어" />
    <input type="date" name="sdate" th:value="${sdate}" />
    <input type="date" name="edate" th:value="${edate}" />
    <input type="hidden" name="sop" th:value="${sop}" />
    <button type="submit">검색</button>
</form>

<div th:if="${error}" th:text="${error}" style="color: red; margin: 8px 0;"></div>
<div th:if="${message}" th:text="${message}" style="color: green; margin: 8px 0;"></div>

<table>
    <thead>
    <tr>
        <th>번호</th>
        <th>제목</th>
        <th>작성자</th>
        <th>
            <a th:href="@{'/bbs/' + ${boTable} + '/list'(page=1, size=${result.size}, sca=${sca}, sfl=${sfl}, stx=${stx}, sop=${sop}, sdate=${sdate}, edate=${edate}, sst='wr_datetime', sod=${sod == 'asc' ? 'desc' : 'asc'})}">작성일</a>
        </th>
        <th>
            <a th:href="@{'/bbs/' + ${boTable} + '/list'(page=1, size=${result.size}, sca=${sca}, sfl=${sfl}, stx=${stx}, sop=${sop}, sdate=${sdate}, edate=${edate}, sst='wr_hit', sod=${sod == 'asc' ? 'desc' : 'asc'})}">조회</a>
        </th>
        <th>댓글</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="post : ${result.items}">
        <td th:text="${post.wrId}">1</td>
        <td>
            <a th:href="@{'/bbs/' + ${boTable} + '/view/' + ${post.wrId}}"
               th:text="${post.wrSubject}">제목</a>
        </td>
        <td th:text="${post.wrName}">작성자</td>
        <td th:text="${post.wrDatetime}">작성일</td>
        <td th:text="${post.wrHit}">0</td>
        <td th:text="${post.wrComment}">0</td>
    </tr>
    </tbody>
</table>

<div class="pagination">
    <span th:text="${result.page}"></span>
    <span>/</span>
    <span th:text="${result.totalPages}"></span>
    <a th:if="${result.page > 1}"
       th:href="@{'/bbs/' + ${boTable} + '/list'(page=${result.page - 1}, size=${result.size}, sca=${sca}, sfl=${sfl}, stx=${stx}, sop=${sop}, sdate=${sdate}, edate=${edate}, sst=${sst}, sod=${sod})}">이전</a>
    <a th:if="${result.page < result.totalPages}"
       th:href="@{'/bbs/' + ${boTable} + '/list'(page=${result.page + 1}, size=${result.size}, sca=${sca}, sfl=${sfl}, stx=${stx}, sop=${sop}, sdate=${sdate}, edate=${edate}, sst=${sst}, sod=${sod})}">다음</a>
</div>

        </div>
    </div>
</div>
    <div th:replace="~{fragments/nav :: nav_end}"></div>
</body>
</html>
