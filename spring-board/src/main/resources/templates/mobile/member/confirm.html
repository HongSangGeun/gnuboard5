<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
    <title>회원 비밀번호 확인</title>
    <link rel="stylesheet" th:href="@{/js/font-awesome/css/font-awesome.min.css}">
    <link rel="stylesheet" th:href="@{/css/mobile-login.css}">
</head>

<body class="mobile-login-body">
    <div class="mobile-login-shell">
        <section class="mobile-login-card" aria-labelledby="mobile-confirm-title">
            <header class="mobile-login-head">
                <img class="mobile-login-logo" th:src="@{/img/logo_gn.svg}" alt="경남 스마트시티 관리포털">
                <h1 id="mobile-confirm-title" class="mobile-login-title">비밀번호 확인</h1>
                <p class="mobile-login-subtitle">
                    안전한 정보 보호를 위해<br>
                    비밀번호를 한 번 더 입력해 주세요.
                </p>
            </header>

            <p th:if="${error}" class="mobile-login-error" th:text="${error}">비밀번호가 일치하지 않습니다.</p>

            <form class="mobile-login-form" name="fmemberconfirm" th:action="@{/member/confirm}" method="post"
                autocomplete="off" th:object="${form}">
                <input type="hidden" th:field="*{url}">
                <input type="hidden" name="_csrf" th:value="${csrfToken}">

                <div class="mobile-login-field">
                    <label class="mobile-login-label">회원아이디</label>
                    <div class="mobile-login-input-wrap" style="background: #f3f4f6; border-color: #e5e7eb;">
                        <i class="mobile-login-icon fa fa-user-o" aria-hidden="true"></i>
                        <div class="mobile-login-input" style="line-height: 48px; color: #6b7280;"
                            th:text="${loginUser != null ? loginUser.id : ''}"></div>
                    </div>
                </div>

                <div class="mobile-login-field">
                    <label class="mobile-login-label" for="confirm_mb_password">비밀번호</label>
                    <div class="mobile-login-input-wrap">
                        <i class="mobile-login-icon fa fa-lock" aria-hidden="true"></i>
                        <input class="mobile-login-input" type="password" id="confirm_mb_password"
                            th:field="*{password}" placeholder="비밀번호를 입력하세요" maxlength="50"
                            autocomplete="current-password" required>
                    </div>
                </div>

                <div style="display: flex; gap: 10px; margin-top: 20px;">
                    <a href="#" data-back class="mobile-login-submit"
                        style="background-color: #9ca3af; text-decoration: none; display: flex; align-items: center; justify-content: center;">취소</a>
                    <button class="mobile-login-submit" type="submit" id="btn_submit">확인</button>
                </div>

            </form>
        </section>
    </div>
    <script th:attr="nonce=${cspNonce}">
        (function () {
            // data-back 핸들러
            document.querySelectorAll('[data-back]').forEach(function(el) {
                el.addEventListener('click', function(e) { e.preventDefault(); history.back(); });
            });
            var btn = document.getElementById('btn_submit');
            var form = document.forms.fmemberconfirm;
            if (!form) return;
            form.addEventListener('submit', function () {
                if (btn) {
                    btn.disabled = true;
                    btn.innerText = "확인 중...";
                }
            });
        })();
    </script>
</body>

</html>