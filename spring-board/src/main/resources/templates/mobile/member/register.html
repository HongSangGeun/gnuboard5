<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
    <title>회원가입</title>
    <link rel="stylesheet" th:href="@{/js/font-awesome/css/font-awesome.min.css}">
    <link rel="stylesheet" th:href="@{/css/mobile-register.css}">
    <style>
        /* 약관 동의 스타일 - 모바일 */
        .terms-section {
            margin-bottom: 24px;
        }

        .terms-agreement-all {
            padding: 16px;
            background: #f8f9fa;
            border-radius: 8px;
            margin-bottom: 16px;
            border: 2px solid #4256e9;
        }

        .terms-checkbox-label {
            display: flex;
            align-items: center;
            cursor: pointer;
            user-select: none;
        }

        .terms-checkbox {
            width: 20px;
            height: 20px;
            margin-right: 10px;
            cursor: pointer;
            accent-color: #4256e9;
            flex-shrink: 0;
        }

        .terms-text-bold {
            font-size: 15px;
            font-weight: 700;
            color: #222;
        }

        .terms-text {
            font-size: 14px;
            font-weight: 600;
            color: #333;
        }

        .terms-subtitle {
            margin: 8px 0 0 30px;
            font-size: 12px;
            color: #666;
            line-height: 1.4;
        }

        .terms-box {
            margin-bottom: 12px;
            border: 1px solid #ddd;
            border-radius: 8px;
            overflow: hidden;
        }

        .terms-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 14px 16px;
            background: #fff;
        }

        .terms-toggle {
            background: none;
            border: none;
            padding: 6px;
            cursor: pointer;
            color: #666;
            font-size: 14px;
            transition: transform 0.3s;
            flex-shrink: 0;
        }

        .terms-toggle.active {
            transform: rotate(180deg);
        }

        .terms-content {
            display: none;
            border-top: 1px solid #eee;
            background: #fafafa;
        }

        .terms-content.show {
            display: block;
        }

        .terms-scroll {
            max-height: 180px;
            overflow-y: auto;
            padding: 16px;
        }

        .terms-scroll h4 {
            font-size: 13px;
            font-weight: 700;
            color: #333;
            margin: 14px 0 6px 0;
        }

        .terms-scroll h4:first-child {
            margin-top: 0;
        }

        .terms-scroll p {
            font-size: 12px;
            line-height: 1.5;
            color: #555;
            margin: 3px 0;
        }

        .terms-scroll p strong {
            font-weight: 600;
            color: #333;
        }

        /* 스크롤바 스타일 */
        .terms-scroll::-webkit-scrollbar {
            width: 4px;
        }

        .terms-scroll::-webkit-scrollbar-track {
            background: #f1f1f1;
        }

        .terms-scroll::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 2px;
        }
    </style>
    <script th:attr="nonce=${cspNonce}">
        function toggleTerms(id) {
            const content = document.getElementById(id);
            const button = content.previousElementSibling.querySelector('.terms-toggle');
            content.classList.toggle('show');
            button.classList.toggle('active');
        }

        document.addEventListener('DOMContentLoaded', function() {
            const agreeAll = document.getElementById('agree_all');
            const agreeTerms = document.getElementById('agree_terms');
            const agreePrivacy = document.getElementById('agree_privacy');

            agreeAll.addEventListener('change', function() {
                const checked = this.checked;
                agreeTerms.checked = checked;
                agreePrivacy.checked = checked;
            });

            [agreeTerms, agreePrivacy].forEach(checkbox => {
                checkbox.addEventListener('change', function() {
                    agreeAll.checked = agreeTerms.checked && agreePrivacy.checked;
                });
            });

            document.getElementById('fregisterform').addEventListener('submit', function(e) {
                if (!agreeTerms.checked || !agreePrivacy.checked) {
                    e.preventDefault();
                    alert('필수 약관에 동의해주세요.');
                    return false;
                }
            });
        });
    </script>
</head>
<body class="mobile-register-body">
<div class="mobile-register-shell">
    <section class="mobile-register-card" aria-labelledby="mobile-register-title">
        <header class="mobile-register-head">
            <img class="mobile-register-logo" th:src="@{/img/logo_gn.svg}" alt="경남 스마트시티 관리포털">
            <h1 id="mobile-register-title" class="mobile-register-title">회원가입</h1>
            <p class="mobile-register-subtitle">필수 정보를 입력해 가입을 진행해 주세요.</p>
        </header>

        <p th:if="${error}" class="mobile-register-message error" th:text="${error}">오류가 발생했습니다.</p>
        <p th:if="${message}" class="mobile-register-message success" th:text="${message}">처리가 완료되었습니다.</p>

        <form class="mobile-register-form" id="fregisterform" th:action="@{/register}" method="post" th:object="${form}">
            <input type="hidden" name="_csrf" th:value="${csrfToken}">

            <!-- 약관 동의 -->
            <div class="terms-section">
                <div class="terms-agreement-all">
                    <label class="terms-checkbox-label">
                        <input type="checkbox" id="agree_all" class="terms-checkbox">
                        <span class="terms-text-bold">전체 동의</span>
                    </label>
                    <p class="terms-subtitle">전체 동의는 필수 및 선택 정보에 대한 동의를 포함합니다.</p>
                </div>

                <div class="terms-box">
                    <div class="terms-header">
                        <label class="terms-checkbox-label">
                            <input type="checkbox" name="agreeTerms" id="agree_terms" class="terms-checkbox" required>
                            <span class="terms-text">[필수] 이용약관 동의</span>
                        </label>
                        <button type="button" class="terms-toggle" onclick="toggleTerms('terms1')">
                            <i class="fa fa-chevron-down"></i>
                        </button>
                    </div>
                    <div id="terms1" class="terms-content">
                        <div class="terms-scroll">
                            <h4>제1조 (목적)</h4>
                            <p>이 약관은 경남도청 스마트시티 관리포털(이하 "포털"이라 합니다)이 제공하는 모든 서비스(이하 "서비스"라 합니다)의 이용조건 및 절차, 회원과 포털의 권리, 의무 및 책임사항 등 기본적인 사항을 규정함을 목적으로 합니다.</p>

                            <h4>제2조 (약관의 효력 및 변경)</h4>
                            <p>① 이 약관은 서비스를 이용하고자 하는 모든 회원에 대하여 그 효력을 발생합니다.</p>
                            <p>② 포털은 필요한 경우 관련 법령을 위배하지 않는 범위 내에서 이 약관을 변경할 수 있으며, 약관이 변경되는 경우 지체 없이 이를 공지합니다.</p>

                            <h4>제3조 (회원가입)</h4>
                            <p>① 회원가입은 이용자가 약관의 내용에 동의하고 회원가입 신청을 한 후 포털이 이를 승낙함으로써 체결됩니다.</p>
                            <p>② 포털은 다음 각 호에 해당하는 신청에 대하여는 승낙을 거부하거나 사후에 회원자격을 상실시킬 수 있습니다.</p>
                            <p>1. 타인의 명의를 이용하여 신청한 경우</p>
                            <p>2. 회원가입 신청서의 내용을 허위로 기재한 경우</p>
                            <p>3. 사회의 안녕질서 또는 미풍양속을 저해할 목적으로 신청한 경우</p>

                            <h4>제4조 (서비스의 제공)</h4>
                            <p>포털은 회원에게 다음과 같은 서비스를 제공합니다.</p>
                            <p>1. 스마트시티 관련 정보 제공 서비스</p>
                            <p>2. 시설물 관리 및 모니터링 서비스</p>
                            <p>3. 게시판 및 커뮤니티 서비스</p>
                            <p>4. 기타 포털이 정하는 서비스</p>

                            <h4>제5조 (회원의 의무)</h4>
                            <p>① 회원은 관계 법령, 이 약관의 규정, 이용안내 및 서비스상에 공지한 주의사항, 포털이 통지하는 사항 등을 준수하여야 하며, 기타 포털의 업무에 방해되는 행위를 하여서는 안 됩니다.</p>
                            <p>② 회원은 포털의 사전 승낙 없이 서비스를 이용하여 영업활동을 할 수 없으며, 그 영업활동의 결과에 대해 포털은 책임을 지지 않습니다.</p>
                            <p>③ 회원은 게시물 작성 시 다음 각 호의 행위를 하여서는 안 됩니다.</p>
                            <p>1. 주민등록번호, 여권번호, 운전면허번호, 외국인등록번호 등 고유식별정보의 게시</p>
                            <p>2. 계좌번호, 신용카드번호 등 금융정보의 게시</p>
                            <p>3. 타인의 개인정보를 동의 없이 수집, 저장, 공개하는 행위</p>
                            <p>4. 비밀번호, 보안코드 등 인증정보의 게시</p>
                            <p>④ 회원이 전항의 민감정보를 게시한 경우, 포털은 사전 통보 없이 해당 게시물을 삭제하거나 비식별화 처리할 수 있습니다.</p>

                            <h4>제6조 (정보보안 및 비밀유지)</h4>
                            <p>① 회원은 서비스 이용 중 취득한 포털 및 다른 회원의 정보를 포털의 사전 승낙 없이 외부로 유출하거나 제3자에게 제공해서는 안 됩니다.</p>
                            <p>② 회원은 다음 각 호의 정보에 대하여 엄격한 비밀유지 의무를 부담합니다.</p>
                            <p>1. 포털의 시스템, 운영, 관리에 관한 정보</p>
                            <p>2. 다른 회원의 개인정보 및 활동 정보</p>
                            <p>3. 포털이 비공개로 지정한 각종 정보 및 자료</p>
                            <p>③ 회원이 본 조의 의무를 위반하여 포털 또는 제3자에게 손해를 입힌 경우, 회원은 그에 대한 모든 민·형사상 책임을 부담합니다.</p>
                            <p>④ 포털은 정보보안 강화를 위해 주기적인 보안점검을 실시하며, 회원은 이에 적극 협조하여야 합니다.</p>

                            <h4>제7조 (개인정보보호)</h4>
                            <p>① 포털은 회원의 개인정보를 보호하기 위하여 「개인정보 보호법」 등 관련 법령을 준수합니다.</p>
                            <p>② 회원은 자신의 개인정보를 보호할 책임이 있으며, 아이디와 비밀번호가 타인에게 노출되지 않도록 관리하여야 합니다.</p>
                            <p>③ 회원은 타인의 개인정보를 도용하거나 부정하게 사용해서는 안 되며, 이를 위반한 경우 관련 법령에 따라 처벌받을 수 있습니다.</p>
                        </div>
                    </div>
                </div>

                <div class="terms-box">
                    <div class="terms-header">
                        <label class="terms-checkbox-label">
                            <input type="checkbox" name="agreePrivacy" id="agree_privacy" class="terms-checkbox" required>
                            <span class="terms-text">[필수] 개인정보 수집 및 이용 동의</span>
                        </label>
                        <button type="button" class="terms-toggle" onclick="toggleTerms('terms2')">
                            <i class="fa fa-chevron-down"></i>
                        </button>
                    </div>
                    <div id="terms2" class="terms-content">
                        <div class="terms-scroll">
                            <h4>1. 개인정보의 수집 및 이용 목적</h4>
                            <p>경남도청 스마트시티 관리포털은 다음의 목적을 위해 개인정보를 수집 및 이용합니다.</p>
                            <p>- 회원제 서비스 이용에 따른 본인 확인 및 개인 식별</p>
                            <p>- 부정 이용 방지 및 비인가 사용 방지</p>
                            <p>- 서비스 제공에 관한 계약 이행 및 서비스 제공에 따른 요금정산</p>
                            <p>- 고충처리 및 분쟁 해결</p>

                            <h4>2. 수집하는 개인정보의 항목</h4>
                            <p><strong>필수항목:</strong> 아이디, 비밀번호, 이름, 닉네임, 이메일</p>
                            <p><strong>자동수집항목:</strong> IP주소, 쿠키, 서비스 이용 기록, 접속 로그</p>

                            <h4>3. 개인정보의 보유 및 이용기간</h4>
                            <p>회원 탈퇴 시까지 보유하며, 탈퇴 후에는 관련 법령에 따라 일정 기간 보관 후 파기합니다.</p>
                            <p>- 계약 또는 청약철회 등에 관한 기록: 5년 (전자상거래법)</p>
                            <p>- 대금결제 및 재화 등의 공급에 관한 기록: 5년 (전자상거래법)</p>
                            <p>- 소비자의 불만 또는 분쟁처리에 관한 기록: 3년 (전자상거래법)</p>
                            <p>- 접속에 관한 기록: 3개월 (통신비밀보호법)</p>

                            <h4>4. 동의를 거부할 권리 및 불이익</h4>
                            <p>귀하는 개인정보 수집 및 이용에 대해 동의를 거부할 권리가 있습니다. 다만, 필수 항목에 대한 동의를 거부할 경우 회원가입이 제한됩니다.</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="mobile-register-field">
                <label class="mobile-register-label" for="reg_mb_id">아이디</label>
                <div class="mobile-register-input-wrap">
                    <i class="mobile-register-icon fa fa-user-o" aria-hidden="true"></i>
                    <input class="mobile-register-input" type="text" id="reg_mb_id" th:field="*{mbId}"
                           placeholder="아이디" maxlength="20" autocomplete="username" required>
                </div>
            </div>

            <div class="mobile-register-field">
                <label class="mobile-register-label" for="reg_mb_password">비밀번호</label>
                <div class="mobile-register-input-wrap">
                    <i class="mobile-register-icon fa fa-lock" aria-hidden="true"></i>
                    <input class="mobile-register-input" type="password" id="reg_mb_password" th:field="*{password}"
                           placeholder="비밀번호" maxlength="50" autocomplete="new-password" required>
                </div>
            </div>

            <div class="mobile-register-field">
                <label class="mobile-register-label" for="reg_mb_password_re">비밀번호 확인</label>
                <div class="mobile-register-input-wrap">
                    <i class="mobile-register-icon fa fa-check-square-o" aria-hidden="true"></i>
                    <input class="mobile-register-input" type="password" id="reg_mb_password_re" th:field="*{passwordConfirm}"
                           placeholder="비밀번호 확인" maxlength="50" autocomplete="new-password" required>
                </div>
            </div>

            <div class="mobile-register-field">
                <label class="mobile-register-label" for="reg_mb_name">이름</label>
                <div class="mobile-register-input-wrap">
                    <i class="mobile-register-icon fa fa-id-badge" aria-hidden="true"></i>
                    <input class="mobile-register-input" type="text" id="reg_mb_name" th:field="*{name}"
                           placeholder="이름" maxlength="30" required>
                </div>
            </div>

            <div class="mobile-register-field">
                <label class="mobile-register-label" for="reg_mb_nick">닉네임</label>
                <div class="mobile-register-input-wrap">
                    <i class="mobile-register-icon fa fa-tag" aria-hidden="true"></i>
                    <input class="mobile-register-input" type="text" id="reg_mb_nick" th:field="*{nick}"
                           placeholder="닉네임" maxlength="30" required>
                </div>
            </div>

            <div class="mobile-register-field">
                <label class="mobile-register-label" for="reg_mb_email">이메일</label>
                <div class="mobile-register-input-wrap">
                    <i class="mobile-register-icon fa fa-envelope-o" aria-hidden="true"></i>
                    <input class="mobile-register-input" type="email" id="reg_mb_email" th:field="*{email}"
                           placeholder="이메일" maxlength="80" autocomplete="email" required>
                </div>
            </div>

            <button class="mobile-register-submit" type="submit">회원가입</button>

            <div class="mobile-register-links">
                이미 계정이 있으신가요?
                <a th:href="@{/login}">로그인</a>
            </div>
        </form>
    </section>
</div>
</body>
</html>
